# ะคัะฝะบัะธั "ะัะนัะธ" (Logout)

## ะะฑะทะพั

ะะพะฑะฐะฒะปะตะฝะฐ ััะฝะบัะธั ัะฐะทะปะพะณะธัะพะฒะฐะฝะธั ะดะปั ะบะพััะตะบัะฝะพะณะพ ะทะฐะฒะตััะตะฝะธั ัะตััะธะธ ะฟะพะปัะทะพะฒะฐัะตะปั.

## ะะฐัะตะผ ะฝัะถะฝะฐ ััะฐ ััะฝะบัะธั?

1. **ะะตะทะพะฟะฐัะฝะพััั** - ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะฒัะนัะธ ะธะท ะฐะบะบะฐัะฝัะฐ ะฝะฐ ะพะฑัะตะผ/ะฟัะฑะปะธัะฝะพะผ ััััะพะนััะฒะต
2. **ะกะผะตะฝะฐ ะฐะบะบะฐัะฝัะพะฒ** - ะะพะทะผะพะถะฝะพััั ะฒะพะนัะธ ะฟะพะด ะดััะณะธะผ Google/Yandex ะฐะบะบะฐัะฝัะพะผ
3. **ะฃะฟัะฐะฒะปะตะฝะธะต ัะตััะธัะผะธ** - ะะพะฝััะพะปั ะฝะฐะด ะฐะบัะธะฒะฝัะผะธ ัะตััะธัะผะธ
4. **UX** - ะกัะฐะฝะดะฐััะฝะฐั ะฟัะฐะบัะธะบะฐ ะฒ ะฒะตะฑ-ะฟัะธะปะพะถะตะฝะธัั

## ะะตะฐะปะธะทะฐัะธั

### Backend (`server/server.js`)

ะะพัั `/auth/logout` ะดะพัััะฟะตะฝ ะฒัะตะณะดะฐ (ะดะฐะถะต ะฒ DEV ัะตะถะธะผะต):

```javascript
fastify.post('/auth/logout', async (request, reply) => {
  try {
    if (request.user) {
      request.logout(); // Passport logout
    }
    if (request.session) {
      request.session.delete(); // ะฃะดะฐะปัะตะผ ัะตััะธั
    }
    return { success: true };
  } catch (error) {
    fastify.log.error('Logout error:', error);
    return { success: true }; // ะัั ัะฐะฒะฝะพ ััะธัะฐะตะผ ััะฟะตัะฝัะผ
  }
});
```

**ะะฐะถะฝะพ:**
- ะะพัั ะฒัะฝะตัะตะฝ ะธะท `setupAuthRoutes()` ััะพะฑั ัะฐะฑะพัะฐะป ะธ ะฑะตะท OAuth
- ะะตะทะพะฟะฐัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- ะัะธััะบะฐ ัะตััะธะธ ัะตัะตะท `request.session.delete()`
- Passport logout ะดะปั ะพัะธััะบะธ ะฟะพะปัะทะพะฒะฐัะตะปั

### Frontend API (`client/src/utils/api.js`)

ะะพะฑะฐะฒะปะตะฝะฐ ััะฝะบัะธั `logout()`:

```javascript
export const logout = async () => {
  const url = `${API_URL}/auth/logout`;
  try {
    const response = await fetch(url, {
      method: 'POST',
      credentials: 'include', // ะะฐะถะฝะพ ะดะปั ะฟะตัะตะดะฐัะธ cookies
    });
    
    if (!response.ok) {
      throw new Error(`Failed to logout: ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    throw error;
  }
};
```

### Header ะบะพะผะฟะพะฝะตะฝั (`client/src/components/Header.jsx`)

ะะพะฒัะน ะบะพะผะฟะพะฝะตะฝั ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะธะฝัะพัะผะฐัะธะธ ะพ ะฟะพะปัะทะพะฒะฐัะตะปะต ะธ ะบะฝะพะฟะบะธ "ะัะนัะธ":

**ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั:**
- โ ะะฐะณััะถะฐะตั ะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปั ัะตัะตะท `/api/me`
- โ ะะพะบะฐะทัะฒะฐะตั email ะฟะพะปัะทะพะฒะฐัะตะปั
- โ ะะฝะพะฟะบะฐ "ะัะนัะธ" ั ะธะบะพะฝะบะพะน
- โ ะะฒัะพะผะฐัะธัะตัะบะธ ัะบััะฒะฐะตััั ะฝะฐ ัััะฐะฝะธัะต `/login`
- โ ะะต ะฟะพะบะฐะทัะฒะฐะตััั ะฒ DEV ัะตะถะธะผะต (ะบะพะณะดะฐ ะฝะตั OAuth)
- โ ะะพัะปะต logout ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตั ะฝะฐ `/login`

**ะะฝะตัะฝะธะน ะฒะธะด:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ค user@email.com        ๐ช ะัะนัะธ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Layout ะพะฑะฝะพะฒะปะตะฝ (`client/src/components/Layout.jsx`)

Header ะดะพะฑะฐะฒะปะตะฝ ะฒ Layout:

```javascript
import Header from './Header';
import Footer from './Footer';

function Layout({ children, className = '' }) {
  return (
    <div className="min-h-screen bg-gray-50 flex flex-col">
      <Header />
      <div className={`max-w-md mx-auto px-4 py-8 flex-grow w-full ${className}`}>
        {children}
      </div>
      <Footer />
    </div>
  );
}
```

## ะกะพััะฐะฝะตะฝะธะต ะฟัะพะณัะตััะฐ

### โ ะัะพะณัะตัั ะฟัะธะฒัะทะฐะฝ ะบ ะฟะพะปัะทะพะฒะฐัะตะปั

ะัะพะฒะตัะตะฝะพ ะฒ `server/db.js`:

1. **ะขะฐะฑะปะธัะฐ `user_progress`** ะธะผะตะตั `user_id`:
```sql
CREATE TABLE user_progress (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  practice_id TEXT NOT NULL,
  completed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id)
)
```

2. **ะัะต ะพะฟะตัะฐัะธะธ ะธัะฟะพะปัะทััั `user_id`:**
```javascript
// ะะพะปััะตะฝะธะต ะฟัะพะณัะตััะฐ
export const getUserProgress = async (userId) => {
  const rows = await dbAll(
    `SELECT practice_id, COUNT(*) as count 
     FROM user_progress 
     WHERE user_id = ? 
     GROUP BY practice_id`,
    [userId]
  );
  // ...
};

// ะะพะฑะฐะฒะปะตะฝะธะต ะฟัะพะณัะตััะฐ
export const addUserProgress = async (userId, practiceId) => {
  return new Promise((resolve, reject) => {
    db.run(
      'INSERT INTO user_progress (user_id, practice_id) VALUES (?, ?)',
      [userId, practiceId],
      // ...
    );
  });
};
```

3. **ะะดะตะฝัะธัะธะบะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั:**
- **Production (OAuth):** `user_id` ะฑะตััััั ะธะท ัะตััะธะธ ะฟะพัะปะต ะฐััะตะฝัะธัะธะบะฐัะธะธ
- **DEV ัะตะถะธะผ:** ะัะฟะพะปัะทัะตััั ัะธะบัะธะฒะฝัะน `user_id = 1`

```javascript
// server/server.js
const userId = request.user?.id || 1; // DEV fallback
```

### โ ะัะพะณัะตัั ัะพััะฐะฝัะตััั ะผะตะถะดั ัะตััะธัะผะธ

**ะกัะตะฝะฐัะธะน 1: ะะดะธะฝ ะฟะพะปัะทะพะฒะฐัะตะปั, ะฝะตัะบะพะปัะบะพ ััััะพะนััะฒ**
1. ะะพะปัะทะพะฒะฐัะตะปั ะทะฐัะพะดะธั ั ัะตะปะตัะพะฝะฐ โ ะัะพัะปััะธะฒะฐะตั 3 ะฟัะฐะบัะธะบะธ
2. ะััะพะดะธั โ ะะฐัะพะดะธั ั ะฟะปะฐะฝัะตัะฐ (ัะพั ะถะต Google/Yandex ะฐะบะบะฐัะฝั)
3. โ ะะธะดะธั ัะพั ะถะต ะฟัะพะณัะตัั (3 ะฟัะพัะปััะธะฒะฐะฝะธั)

**ะกัะตะฝะฐัะธะน 2: ะกะผะตะฝะฐ ะฐะบะบะฐัะฝัะฐ ะฝะฐ ะพะดะฝะพะผ ััััะพะนััะฒะต**
1. ะะพะปัะทะพะฒะฐัะตะปั ะ ะทะฐัะพะดะธั โ ะัะพัะปััะธะฒะฐะตั 5 ะฟัะฐะบัะธะบ
2. ะััะพะดะธั โ ะะพะปัะทะพะฒะฐัะตะปั ะ ะทะฐัะพะดะธั (ะดััะณะพะน ะฐะบะบะฐัะฝั)
3. โ ะะพะปัะทะพะฒะฐัะตะปั ะ ะฒะธะดะธั ัะฒะพะน ะฟัะพะณัะตัั (ะฝะต ะฟัะพะณัะตัั ะฟะพะปัะทะพะฒะฐัะตะปั ะ)

**ะกัะตะฝะฐัะธะน 3: Logout ะธ ะฟะพะฒัะพัะฝัะน ะฒัะพะด**
1. ะะพะปัะทะพะฒะฐัะตะปั ะฟัะพัะปััะธะฒะฐะตั ะฟัะฐะบัะธะบั โ ะัะพะณัะตัั ะทะฐะฟะธัะฐะฝ ะฒ ะะ
2. ะะฐะถะธะผะฐะตั "ะัะนัะธ" โ ะกะตััะธั ัะดะฐะปะตะฝะฐ
3. ะกะฝะพะฒะฐ ะฒัะพะดะธั ัะตัะตะท Google/Yandex โ ะกะตััะธั ัะพะทะดะฐะฝะฐ
4. โ ะัะพะณัะตัั ัะพััะฐะฝะธะปัั (ะฟัะธะฒัะทะฐะฝ ะบ `user_id`, ะฐ ะฝะต ะบ ัะตััะธะธ)

## ะะดะตะฝัะธัะธะบะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั

### Production (ั OAuth)

**ะขะฐะฑะปะธัะฐ `users`:**
```sql
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  provider TEXT NOT NULL,           -- 'google' ะธะปะธ 'yandex'
  provider_id TEXT NOT NULL,        -- ID ะพั ะฟัะพะฒะฐะนะดะตัะฐ
  email TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(provider, provider_id)     -- ะะดะธะฝ ะฟะพะปัะทะพะฒะฐัะตะปั = ะพะดะฝะฐ ะทะฐะฟะธัั
)
```

**ะัะพัะตัั:**
1. ะะพะปัะทะพะฒะฐัะตะปั ะฒัะพะดะธั ัะตัะตะท Google/Yandex
2. OAuth ะฒะพะทะฒัะฐัะฐะตั `provider_id` (ัะฝะธะบะฐะปัะฝัะน ID ะพั Google/Yandex)
3. ะัะธะปะพะถะตะฝะธะต ะธัะตั ะฟะพะปัะทะพะฒะฐัะตะปั: `findUserByProviderId(provider, provider_id)`
4. ะัะปะธ ะฝะต ะฝะฐะนะดะตะฝ โ ัะพะทะดะฐัั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
5. ะัะปะธ ะฝะฐะนะดะตะฝ โ ะธัะฟะพะปัะทัะตั ัััะตััะฒัััะธะน `user_id`
6. `user_id` ัะพััะฐะฝัะตััั ะฒ ัะตััะธะธ

**ะะปััะตะฒะพะน ะผะพะผะตะฝั:**
- `provider_id` ะพั Google/Yandex **ะฒัะตะณะดะฐ ะพะดะธะฝะฐะบะพะฒัะน** ะดะปั ะพะดะฝะพะณะพ ะธ ัะพะณะพ ะถะต ะฐะบะบะฐัะฝัะฐ
- ะะฐะถะต ะตัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฒัะนะดะตั ะธ ัะฝะพะฒะฐ ะฒะพะนะดัั ั ะดััะณะพะณะพ ััััะพะนััะฒะฐ
- ะะฐะถะต ะตัะปะธ ัะดะฐะปะธั cookies ะธ ะพัะธััะธั ะบะตั
- `provider_id` = ะฟะพััะพัะฝะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ะฟะพะปัะทะพะฒะฐัะตะปั

### DEV ัะตะถะธะผ (ะฑะตะท OAuth)

ะัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ัะฐะฑะพัะฐัั ะฟะพะด `user_id = 1`:

```javascript
const userId = request.user?.id || 1;
```

**ะะณัะฐะฝะธัะตะฝะธั DEV ัะตะถะธะผะฐ:**
- ะะตั ัะตะฐะปัะฝะพะน ะฐะฒัะพัะธะทะฐัะธะธ
- ะัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ะฒะธะดัั ะพะดะธะฝ ะธ ัะพั ะถะต ะฟัะพะณัะตัั
- Header ะฝะต ะฟะพะบะฐะทัะฒะฐะตััั (ะฝะตั ะฟะพะปัะทะพะฒะฐัะตะปั)
- ะะฝะพะฟะบะฐ "ะัะนัะธ" ะฝะต ะฟะพะบะฐะทัะฒะฐะตััั

## ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั 1: ะัะพะฒะตัะบะฐ logout

**ะจะฐะณะธ:**
1. ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต ั OAuth (production)
2. ะะพะนะดะธัะต ัะตัะตะท Google ะธะปะธ Yandex
3. ะัะพะฒะตัััะต, ััะพ ะฒ ะฟัะฐะฒะพะผ ะฒะตััะฝะตะผ ัะณะปั ะฟะพัะฒะธะปัั email
4. ะะฐะถะผะธัะต "ะัะนัะธ"
5. โ ะะพะปะถะตะฝ ะฟะตัะตะฝะฐะฟัะฐะฒะธัั ะฝะฐ `/login`
6. โ Header ะดะพะปะถะตะฝ ะธััะตะทะฝััั
7. โ ะัะธ ะฟะพะฟััะบะต ะทะฐะนัะธ ะฝะฐ ะฒะฝัััะตะฝะฝะธะต ัััะฐะฝะธัั ะดะพะปะถะตะฝ ัะตะดะธัะตะบัะธัั ะฝะฐ `/login`

### ะขะตัั 2: ะกะพััะฐะฝะตะฝะธะต ะฟัะพะณัะตััะฐ

**ะจะฐะณะธ:**
1. ะะพะนะดะธัะต ะฒ ะฟัะธะปะพะถะตะฝะธะต
2. ะัะพัะปััะฐะนัะต ะฟัะฐะบัะธะบั (ะฟะพะดะพะถะดะธัะต 30 ัะตะบ)
3. ะัะพะฒะตัััะต, ััะพ ะฟัะพัะปััะธะฒะฐะฝะธะต ะทะฐััะธัะฐะฝะพ
4. ะะฐะถะผะธัะต "ะัะนัะธ"
5. ะกะฝะพะฒะฐ ะฒะพะนะดะธัะต (ัะพั ะถะต ะฐะบะบะฐัะฝั)
6. โ ะัะพะณัะตัั ะดะพะปะถะตะฝ ัะพััะฐะฝะธัััั

### ะขะตัั 3: ะกะผะตะฝะฐ ะฐะบะบะฐัะฝัะฐ

**ะะพะดะณะพัะพะฒะบะฐ:**
- ะัะถะฝั ะดะฒะฐ ัะฐะทะฝัั Google/Yandex ะฐะบะบะฐัะฝัะฐ

**ะจะฐะณะธ:**
1. ะะพะนะดะธัะต ะบะฐะบ ะะพะปัะทะพะฒะฐัะตะปั ะ
2. ะัะพัะปััะฐะนัะต 3 ะฟัะฐะบัะธะบะธ
3. ะะฐะถะผะธัะต "ะัะนัะธ"
4. ะะพะนะดะธัะต ะบะฐะบ ะะพะปัะทะพะฒะฐัะตะปั ะ
5. โ ะัะพะณัะตัั ะดะพะปะถะตะฝ ะฑััั ะฟัััะพะน (ะธะปะธ ัะฒะพะน, ะตัะปะธ ัะถะต ะฟะพะปัะทะพะฒะฐะปัั)
6. ะัะพัะปััะฐะนัะต 2 ะฟัะฐะบัะธะบะธ
7. ะัะนะดะธัะต โ ะะพะนะดะธัะต ะบะฐะบ ะะพะปัะทะพะฒะฐัะตะปั ะ
8. โ ะะพะปะถะตะฝ ะฒะธะดะตัั ัะฒะพะธ 3 ะฟัะพัะปััะธะฒะฐะฝะธั (ะฝะต 2 ะพั ะะพะปัะทะพะฒะฐัะตะปั ะ)

### ะขะตัั 4: DEV ัะตะถะธะผ

**ะจะฐะณะธ:**
1. ะะฐะฟัััะธัะต ะฒ DEV ัะตะถะธะผะต (`npm run dev` ะฑะตะท OAuth ะฟะตัะตะผะตะฝะฝัั)
2. ะัะบัะพะนัะต ะฟัะธะปะพะถะตะฝะธะต
3. โ Header ะฝะต ะดะพะปะถะตะฝ ะฟะพะบะฐะทัะฒะฐัััั
4. โ ะะพะถะฝะพ ะฟะพะปัะทะพะฒะฐัััั ะฟัะธะปะพะถะตะฝะธะตะผ ะฑะตะท ะฐะฒัะพัะธะทะฐัะธะธ
5. โ ะัะพะณัะตัั ะทะฐะฟะธััะฒะฐะตััั ะฟะพะด `user_id = 1`

### ะขะตัั 5: ะะตัะบะพะปัะบะพ ััััะพะนััะฒ

**ะะพะดะณะพัะพะฒะบะฐ:**
- ะฃัััะพะนััะฒะพ 1 (ะฝะฐะฟัะธะผะตั, ัะตะปะตัะพะฝ)
- ะฃัััะพะนััะฒะพ 2 (ะฝะฐะฟัะธะผะตั, ะบะพะผะฟัััะตั)
- ะะดะธะฝ ะธ ัะพั ะถะต Google/Yandex ะฐะบะบะฐัะฝั

**ะจะฐะณะธ:**
1. ะะฐ ััััะพะนััะฒะต 1: ะฒะพะนะดะธัะต โ ะฟัะพัะปััะฐะนัะต 5 ะฟัะฐะบัะธะบ
2. ะะฐ ััััะพะนััะฒะต 2: ะฒะพะนะดะธัะต (ัะพั ะถะต ะฐะบะบะฐัะฝั)
3. โ ะะพะปะถะฝั ะฒะธะดะตัั 5 ะฟัะพัะปััะธะฒะฐะฝะธะน ั ััััะพะนััะฒะฐ 1
4. ะะฐ ััััะพะนััะฒะต 2: ะฟัะพัะปััะฐะนัะต ะตัั 2 ะฟัะฐะบัะธะบะธ
5. ะะฐ ััััะพะนััะฒะต 1: ะพะฑะฝะพะฒะธัะต ัััะฐะฝะธัั
6. โ ะะพะปะถะฝั ะฒะธะดะตัั 7 ะฟัะพัะปััะธะฒะฐะฝะธะน (5 + 2)

## ะะตะทะพะฟะฐัะฝะพััั

### โ ะะฐัะธัะฐ ัะตััะธะน

1. **httpOnly cookies** - ะะฐัะธัะฐ ะพั XSS ะฐัะฐะบ:
```javascript
cookie: {
  path: '/',
  httpOnly: true, // JavaScript ะฝะต ะผะพะถะตั ะฟะพะปััะธัั ะดะพัััะฟ ะบ cookie
  secure: process.env.NODE_ENV === 'production' // HTTPS only ะฒ production
}
```

2. **Secure session secret:**
```javascript
secret: process.env.SESSION_SECRET || '12345678901234567890123456789012'
```

3. **CORS ั credentials:**
```javascript
await fastify.register(cors, {
  origin: [process.env.FRONTEND_URL || 'http://localhost:5173'],
  credentials: true // ะะฐะทัะตัะฐะตะผ cookies
});
```

### โ ะะฐัะธัะฐ ะพั session fixation

ะัะธ logout:
1. `request.logout()` - ะพัะธัะฐะตั Passport ะดะฐะฝะฝัะต
2. `request.session.delete()` - **ะฟะพะปะฝะพัััั ัะดะฐะปัะตั ัะตััะธั**
3. ะกะพะทะดะฐัััั ะฝะพะฒะฐั ัะตััะธั ะฟัะธ ัะปะตะดัััะตะผ ะฒัะพะดะต

### โ๏ธ ะะตะบะพะผะตะฝะดะฐัะธะธ

1. **ะัะฟะพะปัะทัะนัะต ัะธะปัะฝัะน SESSION_SECRET:**
```bash
# ะะตะฝะตัะฐัะธั ัะตะบัะตัะฐ
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

2. **HTTPS ะฒ production:**
- `secure: true` ะฒ cookie ัะฐะฑะพัะฐะตั ัะพะปัะบะพ ั HTTPS
- ะะต ะธัะฟะพะปัะทัะนัะต HTTP ะฒ production

3. **ะะตะณัะปััะฝะฐั ัะพัะฐัะธั ัะตะบัะตัะพะฒ:**
- ะะตะฝัะนัะต `SESSION_SECRET` ะฟะตัะธะพะดะธัะตัะบะธ (ะฝะฐะฟัะธะผะตั, ัะฐะท ะฒ 3 ะผะตัััะฐ)
- ะัะธ ัะผะตะฝะต ะฒัะต ััะฐััะต ัะตััะธะธ ััะฐะฝัั ะฝะตะดะตะนััะฒะธัะตะปัะฝัะผะธ (ััะพ ะฝะพัะผะฐะปัะฝะพ)

## ะะพะทะผะพะถะฝัะต ะฟัะพะฑะปะตะผั ะธ ัะตัะตะฝะธั

### ะัะพะฑะปะตะผะฐ: ะะฝะพะฟะบะฐ "ะัะนัะธ" ะฝะต ะฟะพะบะฐะทัะฒะฐะตััั

**ะัะธัะธะฝะฐ:** ะัะธะปะพะถะตะฝะธะต ะฒ DEV ัะตะถะธะผะต ะฑะตะท OAuth

**ะะตัะตะฝะธะต:** 
- ะ DEV ัะตะถะธะผะต ะบะฝะพะฟะบะฐ ะฝะต ะฟะพะบะฐะทัะฒะฐะตััั (ััะพ ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต)
- ะะปั ัะตััะธัะพะฒะฐะฝะธั logout ะฝะฐัััะพะนัะต OAuth (ัะผ. README.md)

### ะัะพะฑะปะตะผะฐ: ะะพัะปะต logout ะฝะต ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตั ะฝะฐ /login

**ะัะธัะธะฝะฐ:** ะะพะทะผะพะถะฝะพ ะพัะธะฑะบะฐ ะฒ JavaScript

**ะะตัะตะฝะธะต:**
1. ะัะบัะพะนัะต ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ (F12)
2. ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ะพัะธะฑะพะบ
3. ะัะพะฒะตัััะต, ััะพ `useNavigate()` ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ

### ะัะพะฑะปะตะผะฐ: ะัะพะณัะตัั ะฝะต ัะพััะฐะฝัะตััั ะฟะพัะปะต logout

**ะัะธัะธะฝะฐ:** ะะฐะปะพะฒะตัะพััะฝะพ, ะฝะพ ะฒะพะทะผะพะถะฝะพ ะฟัะพะฑะปะตะผะฐ ั ะะ

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ะปะพะณะธ ัะตัะฒะตัะฐ
2. ะฃะฑะตะดะธัะตัั, ััะพ `database.sqlite` ัะพะทะดะฐะฝ ะธ ะธะผะตะตั ะฟัะฐะฒะธะปัะฝัะต ะฟัะฐะฒะฐ
3. ะัะพะฒะตัััะต ัะฐะฑะปะธัั `user_progress`:
```bash
sqlite3 server/database.sqlite "SELECT * FROM user_progress LIMIT 10;"
```

### ะัะพะฑะปะตะผะฐ: "Failed to logout: 401"

**ะัะธัะธะฝะฐ:** ะะตั ะฐะบัะธะฒะฝะพะน ัะตััะธะธ

**ะะตัะตะฝะธะต:** ะญัะพ ะฝะต ะบัะธัะธัะฝะพ - logout ะฒัั ัะฐะฒะฝะพ ะฒัะฟะพะปะฝะธััั ะปะพะบะฐะปัะฝะพ

## ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะปัััะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### 1. ะะพะดัะฒะตัะถะดะตะฝะธะต logout

ะะพะฑะฐะฒะธัั ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ "ะั ัะฒะตัะตะฝั, ััะพ ัะพัะธัะต ะฒัะนัะธ?":

```javascript
const [showConfirm, setShowConfirm] = useState(false);

const handleLogout = async () => {
  if (!showConfirm) {
    setShowConfirm(true);
    return;
  }
  // ... logout logic
};
```

### 2. ะะพะบะฐะทัะฒะฐัั ะธะผั ะฟะพะปัะทะพะฒะฐัะตะปั

ะะผะตััะพ email ะฟะพะบะฐะทัะฒะฐัั ะธะผั (ะตัะปะธ ะดะพัััะฟะฝะพ ะพั OAuth ะฟัะพะฒะฐะนะดะตัะฐ):

```javascript
// ะ db.js ะดะพะฑะฐะฒะธัั ะฟะพะปะต name
// ะ auth.js ัะพััะฐะฝััั name ะธะท profile
// ะ Header.jsx ะฟะพะบะฐะทัะฒะฐัั name || email
```

### 3. ะกะฟะธัะพะบ ะฐะบัะธะฒะฝัั ัะตััะธะน

ะะพะบะฐะทัะฒะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒัะต ะฐะบัะธะฒะฝัะต ัะตััะธะธ ะธ ะฟะพะทะฒะพะปััั ะธั ะทะฐะฒะตััะฐัั.

### 4. ะะฒัะพะผะฐัะธัะตัะบะธะน logout

ะะฒัะพะผะฐัะธัะตัะบะธ ะฒััะพะดะธัั ะฟะพัะปะต N ะผะธะฝัั ะฝะตะฐะบัะธะฒะฝะพััะธ:

```javascript
// ะ Header.jsx
useEffect(() => {
  let timeout;
  const resetTimeout = () => {
    clearTimeout(timeout);
    timeout = setTimeout(handleLogout, 30 * 60 * 1000); // 30 ะผะธะฝัั
  };
  
  window.addEventListener('mousemove', resetTimeout);
  window.addEventListener('keypress', resetTimeout);
  
  resetTimeout();
  
  return () => {
    window.removeEventListener('mousemove', resetTimeout);
    window.removeEventListener('keypress', resetTimeout);
    clearTimeout(timeout);
  };
}, []);
```

## ะะฐะบะปััะตะฝะธะต

ะคัะฝะบัะธั logout ัะตะฐะปะธะทะพะฒะฐะฝะฐ ะธ ะฟะพะปะฝะพัััั ัะฐะฑะพัะพัะฟะพัะพะฑะฝะฐ:

โ **Backend:** ะะพัั `/auth/logout` ะดะพัััะฟะตะฝ ะฒัะตะณะดะฐ  
โ **Frontend:** API ััะฝะบัะธั `logout()` ะธ ะบะพะผะฟะพะฝะตะฝั `Header`  
โ **ะะตะทะพะฟะฐัะฝะพััั:** ะะพะปะฝะฐั ะพัะธััะบะฐ ัะตััะธะธ  
โ **ะัะพะณัะตัั:** ะัะธะฒัะทะฐะฝ ะบ `user_id`, ัะพััะฐะฝัะตััั ะผะตะถะดั ัะตััะธัะผะธ  
โ **UX:** ะะฒัะพะผะฐัะธัะตัะบะพะต ัะบัััะธะต ะฒ DEV ัะตะถะธะผะต ะธ ะฝะฐ ัััะฐะฝะธัะต login  
โ **ะขะตััะธัะพะฒะฐะฝะธะต:** ะะพัะพะฒะฐ ะบ ัะตััะธัะพะฒะฐะฝะธั ะฝะฐ production ั OAuth  

ะัะพะณัะตัั ะฟะพะปัะทะพะฒะฐัะตะปั **ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะพััะฐะฝัะตััั** ะฟัะธ logout ะธ ะดะพัััะฟะตะฝ ะฟะพัะปะต ะฟะพะฒัะพัะฝะพะณะพ ะฒัะพะดะฐ ั ะปัะฑะพะณะพ ััััะพะนััะฒะฐ.

