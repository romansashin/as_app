# =============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# ВАЖНО: Скопируйте этот файл в .env и заполните реальными значениями
# cp env.production.example .env
# НИКОГДА не коммитьте .env файл с секретами в git!
# =============================================================================

# -----------------------------------------------------------------------------
# Application Environment
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=4000

# Host port for binding (если приложение доступно на другом порту снаружи)
# Например, если nginx проксирует на 4000, но снаружи это порт 3000
HOST_PORT=4000

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Уровни: fatal, error, warn, info, debug, trace
# Рекомендуется 'info' для production, 'debug' для отладки
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
# Путь к SQLite базе данных внутри контейнера
DATABASE_PATH=/app/database.sqlite

# Директория на хосте для хранения базы данных (для docker-compose)
DB_VOLUME_PATH=./data

# -----------------------------------------------------------------------------
# Backups
# -----------------------------------------------------------------------------
# Директория на хосте для хранения бэкапов (будет проброшена в /app/backups)
BACKUP_VOLUME_PATH=./backups

# Количество дней хранения бэкапов (старые будут удалены автоматически)
BACKUP_RETENTION_DAYS=30

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# SESSION_SECRET: Криптостойкий случайный ключ (минимум 32 символа)
# Сгенерируйте с помощью: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SESSION_SECRET=CHANGE_ME_GENERATE_RANDOM_SECRET_HERE

# Trust Proxy: ОБЯЗАТЕЛЬНО установите true если приложение за reverse proxy
# (nginx, traefik, cloudflare и т.д.)
TRUST_PROXY=true

# -----------------------------------------------------------------------------
# OAuth Configuration
# -----------------------------------------------------------------------------
# Google OAuth: https://console.cloud.google.com/apis/credentials
# 1. Создайте OAuth 2.0 Client ID
# 2. Добавьте Authorized redirect URI: https://your-backend-domain.com/auth/google/callback
GOOGLE_CLIENT_ID=your-google-client-id-here
GOOGLE_CLIENT_SECRET=your-google-client-secret-here

# Yandex OAuth: https://oauth.yandex.ru/
# 1. Создайте приложение
# 2. Добавьте Callback URL: https://your-backend-domain.com/auth/yandex/callback
# 3. Запросите права: login:email, login:info
YANDEX_CLIENT_ID=your-yandex-client-id-here
YANDEX_CLIENT_SECRET=your-yandex-client-secret-here

# -----------------------------------------------------------------------------
# URLs Configuration
# -----------------------------------------------------------------------------
# BACKEND_URL: Полный URL backend API (для OAuth callbacks)
# Пример: https://api.yourdomain.com или https://yourdomain.com/api
BACKEND_URL=https://api.yourdomain.com

# FRONTEND_URL: Полный URL frontend приложения (для CORS и OAuth redirects)
# Пример: https://yourdomain.com
FRONTEND_URL=https://yourdomain.com

# VITE_API_URL: URL для frontend (используется при сборке client)
# Обычно совпадает с BACKEND_URL
VITE_API_URL=https://api.yourdomain.com

# =============================================================================
# DEPLOYMENT NOTES
# =============================================================================
# 
# 1. REVERSE PROXY SETUP:
#    - Настройте nginx/traefik для проксирования на порт ${PORT}
#    - Убедитесь, что proxy передает заголовки X-Forwarded-*
#    - Включите HTTPS с валидным SSL сертификатом
# 
# 2. OAUTH CALLBACKS:
#    - Google: ${BACKEND_URL}/auth/google/callback
#    - Yandex: ${BACKEND_URL}/auth/yandex/callback
#    - Обязательно добавьте эти URLs в настройки OAuth провайдеров!
# 
# 3. VOLUMES:
#    - База данных будет сохранена в ${DB_VOLUME_PATH}/database.sqlite
#    - Бэкапы будут в ${BACKUP_VOLUME_PATH}/
#    - Убедитесь, что эти директории существуют и доступны для записи
# 
# 4. BACKUPS:
#    - Автоматический бэкап выполняется каждое воскресенье в 3:00 AM
#    - Бэкапы старше ${BACKUP_RETENTION_DAYS} дней удаляются автоматически
#    - Для ручного бэкапа: docker exec <container> /app/scripts/backup-db.sh
# 
# 5. SECURITY CHECKLIST:
#    - ✓ Сгенерирован криптостойкий SESSION_SECRET
#    - ✓ TRUST_PROXY=true если за reverse proxy
#    - ✓ Используется HTTPS в production
#    - ✓ OAuth credentials настроены и секретны
#    - ✓ .env файл добавлен в .gitignore
# 
# =============================================================================
